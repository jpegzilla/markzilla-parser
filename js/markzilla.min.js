var jsonObject,inputFile,filePath="/../mkz/test.mkz",postObject={},yyyymmdd=function(){var c=new Date,a=c.getFullYear().toString(),b=(c.getMonth()+1).toString(),c=c.getDate().toString();1==c.length&&(c="0"+c);1==b.length&&(b="0"+b);return{yyyymmdd:a+b+c,y:a,m:b,d:c}},parseDateString=function(c){if(!/^(\d){8}$/.test(c))return"invalid date";var a=c.substr(0,4),b=c.substr(4,2);c=c.substr(6,2);return{y:a,m:b,d:c}},markzilla=mkz={parse:function(c){$.get(c,function(a){inputFile=a}).then(function(a){var b=
a.split("\n"),c=[];for(a=0;a<b.length;a++)/^#/.test(b[a])?c.push(b[a]):/\n\r/.test(b[a])||/^\s/.test(b[a])||""==b[a]||/^\/\//.test(b[a])||(c[c.length-1]=c[c.length-1]+="<br>"+b[a]);b=[];for(a=0;a<c.length;a++)switch(lineText=c[a].split(/^#[a-z]*[0-9]*\s/)[1],lineType=c[a].split(/\s/)[0].split("#")[1],line=c[a],lineType){case "h1":case "h2":case "h3":case "h4":case "h5":case "h6":case "p":case "code":d="<"+lineType+">"+lineText+"</"+lineType+">";b.push(d);break;case "img":x=lineText.split(/(^.*\/\S*)/),
imgPath=x[1],imgAlt=x[2].trim(),d="<"+lineType+' src="'+imgPath+'" alt="'+imgAlt+'">',b.push(d)}var c=/(\[[^\\a].*?\])/gi,g=/(\[[a].*?\]\(.*?\))/gi,l=/(\[\\)/gi,h=/(\[[a].*?\])/,k=/(\(.*?\))/;for(a=0;a<b.length;a++){var d=b[a].match(c),e=b[a].match(g);if(e&&d){var e=b[a],f;el=b[a].match(c);for(var d=0;d<el.length;d++)currentHL=el[d],elPosition=b[a].indexOf(el[d]),elType=el[d].replace(/(\[|\])/gi,"").substr(0,el[d].replace(/(\[|\])/gi,"").indexOf(" ")),elType=elType.split("").join(" "),elContent=el[d].replace(/(\[|\])/gi,
"").substr(el[d].replace(/(\[|\])/gi,"").indexOf(" ")+1),e.substr(elPosition,currentHL.length),elToLast=currentHL.length+elPosition,lineLength=e.length,hLlength=currentHL.length,f=b[a].substr(0,elPosition)+("<span class='"+elType+"'>"+elContent+"</span>")+b[a].substr(elToLast,lineLength),b[a]=f;el=b[a].match(g);for(d=0;d<el.length;d++)e=b[a],lineLength=e.length,elPosition=b[a].indexOf(el[d]),currentLink=el[d],linkText=currentLink.match(h)[0].replace(/(\[|\])/gi,""),linkAdd=currentLink.match(k)[0].replace(/(\(|\))/gi,
""),elToLast=currentLink.length+elPosition,f=b[a].substr(0,elPosition)+('<a target="_blank" href="'+linkAdd+'">'+linkText+"</a>")+b[a].substr(elToLast,lineLength),b[a]=f}else if(d)for(e=b[a],el=b[a].match(c),d=0;d<el.length;d++)currentHL=el[d],elPosition=b[a].indexOf(el[d]),elType=el[d].replace(/(\[|\])/gi,"").substr(0,el[d].replace(/(\[|\])/gi,"").indexOf(" ")),elType=elType.split("").join(" "),elContent=el[d].replace(/(\[|\])/gi,"").substr(el[d].replace(/(\[|\])/gi,"").indexOf(" ")+1),e.substr(elPosition,
currentHL.length),elToLast=currentHL.length+elPosition,lineLength=e.length,hLlength=currentHL.length,f=b[a].substr(0,elPosition)+("<span class='"+elType+"'>"+elContent+"</span>")+b[a].substr(elToLast,lineLength),b[a]=f;else if(e)for(el=b[a].match(g),d=0;d<el.length;d++)line=b[a],lineLength=line.length,elPosition=b[a].indexOf(el[d]),currentLink=el[d],linkText=currentLink.match(h)[0].replace(/(\[|\])/gi,""),linkAdd=currentLink.match(k)[0].replace(/(\(|\))/gi,""),elToLast=currentLink.length+elPosition,
finalLine=b[a].substr(0,elPosition)+('<a target="_blank" href="'+linkAdd+'">'+linkText+"</a>")+b[a].substr(elToLast,lineLength),b[a]=finalLine}for(a=0;a<b.length;a++)b[a]=b[a].replace(l,"[");console.log(b)})},decon:function(c){console.log("converting from .html to .mkz")},save:function(c){console.log("saving as json object.")}};
